stagingDirectory: "/tmp"

s3:
  enabled: true
  bucket: "your-s3-bucket-name"
  region: "us-east-1"
  prefix: "encode-reports"
  manifest_path: "/tmp/manifests"

connections:
  - name: metadb
    type: MariaDB
    dsn: "${DB_USER}:${DB_PASSWORD}@tcp(${DB_HOST}:${DB_PORT})/${DB_NAME}"

  - name: postgres_db
    type: PostgreSQL
    dsn: "postgres://${PG_USER}:${PG_PASSWORD}@${PG_HOST}:${PG_PORT}/${PG_DB}"

reports:
  - name: circulation_report
    connection: metadb
    query_params:
      query: "SELECT date, checkouts, renewals FROM circulation_stats WHERE date >= CURDATE() - INTERVAL 1 DAY"
    schedule: "0 2 * * *" # Daily at 2 AM

  - name: users_report
    connection: postgres_db
    query_params:
      query: "SELECT id, name, email, created_at FROM users WHERE updated_at >= NOW() - INTERVAL '1 day'"
    schedule: "0 0 1 * *" # First of every month at midnight
